<!DOCTYPE html> <html lang="en-us"> <head> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> 911 Calls - Exploratory Data Analysis &middot; Sajal Sharma </title> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-28655816-2', 'auto'); ga('send', 'pageview'); </script> <link type="text/css" rel="stylesheet" href="/assets/main.css"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png"> <link rel="shortcut icon" type="image/png" href="/public/favicon.png"> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <title>911 Calls - Exploratory Data Analysis | Sajal Sharma</title> <meta property="og:title" content="911 Calls - Exploratory Data Analysis" /> <meta name="author" content="Sajal Sharma" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Exploratory Data Analysis of the 911 calls dataset hosted on Kaggle. Demonstrates extraction of useful features from different variables." /> <meta property="og:description" content="Exploratory Data Analysis of the 911 calls dataset hosted on Kaggle. Demonstrates extraction of useful features from different variables." /> <link rel="canonical" href="http://www.sajalsharma.com/portfolio/911_calls_eda" /> <meta property="og:url" content="http://www.sajalsharma.com/portfolio/911_calls_eda" /> <meta property="og:site_name" content="Sajal Sharma" /> <script type="application/ld+json"> {"@context":"http://schema.org","@type":"WebPage","headline":"911 Calls - Exploratory Data Analysis","author":{"@type":"Person","name":"Sajal Sharma"},"description":"Exploratory Data Analysis of the 911 calls dataset hosted on Kaggle. Demonstrates extraction of useful features from different variables.","url":"http://www.sajalsharma.com/portfolio/911_calls_eda"}</script> </head> <body> <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"> <div class="sidebar" id="sidebar"> <div class="sidebar-item"> <div> <img src="/public/biopic.jpg"> </div> <p>Welcome to the internet home of <a href="http://sajalsharma.com">Sajal Sharma</a>. Data Scientist, Software Engineer, and amateur Philosopher. </p> <p>Feel free to look around, check out my portfolio, or get in touch.</p> <div class="social-icons"> <a href="https://www.linkedin.com/in/sajals" target="_blank"><i class="fa fa-linkedin-square fa-2x" aria-hidden="true"></i></a> <a href="https://github.com/sajal2692" target="_blank"><i class="fa fa-github fa-2x" aria-hidden="true"></i></a> <a href="https://twitter.com/sajal2692"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i></a> </div> </div> <nav class="sidebar-nav"> <a class="sidebar-nav-item" href="/">Home</a> <a class="sidebar-nav-item" href="/portfolio">Portfolio</a> <a class="sidebar-nav-item" href="/about">About</a> <a class="sidebar-nav-item" href="/resume">Resume</a> <span class="sidebar-nav-item">Currently v1.0.1</span> </nav> <div class="sidebar-item"> <p>Built with <i class="fa fa-heart" aria-hidden="true"></i> + <a href="http://www.jekyllrb.com">Jekyll</a>.</p> <p> &copy; 2017 Sajal Sharma. All rights reserved. </p> </div> </div> <div class="wrap"> <div class="masthead"> <div class="container"> </div> </div> <div class="container content"> <div class="notebook"> <h1 class="notebook-title">911 Calls - Exploratory Data Analysis</h1> <div class="project-skills"> Skills: Python, Pandas, Seaborn </div> <a target="_blank" href=https://github.com/sajal2692/data-science-portfolio/blob/master/911%20Calls%20-%20Exploratory%20Analysis.ipynb>Github</a> <hr /> <h2 id="introduction">Introduction</h2> <p>For this project we’ll analyze the 911 call dataset from <a href="https://www.kaggle.com/mchirico/montcoalert">Kaggle</a>. The data contains the following fields:</p> <ul> <li>lat : String variable, Latitude</li> <li>lng: String variable, Longitude</li> <li>desc: String variable, Description of the Emergency Call</li> <li>zip: String variable, Zipcode</li> <li>title: String variable, Title</li> <li>timeStamp: String variable, YYYY-MM-DD HH:MM:SS</li> <li>twp: String variable, Township</li> <li>addr: String variable, Address</li> <li>e: String variable, Dummy variable (always 1)</li> </ul> <p>Let’s start with some data analysis and visualisation imports.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'whitegrid'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#Reading the data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/911.csv'</span><span class="p">)</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 99492 entries, 0 to 99491
Data columns (total 9 columns):
lat          99492 non-null float64
lng          99492 non-null float64
desc         99492 non-null object
zip          86637 non-null float64
title        99492 non-null object
timeStamp    99492 non-null object
twp          99449 non-null object
addr         98973 non-null object
e            99492 non-null int64
dtypes: float64(3), int64(1), object(5)
memory usage: 6.8+ MB
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#Checking the head of the dataframe</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div> <div> <table border="1" class="dataframe table-responsive"> <thead> <tr style="text-align: right;"> <th></th> <th>lat</th> <th>lng</th> <th>desc</th> <th>zip</th> <th>title</th> <th>timeStamp</th> <th>twp</th> <th>addr</th> <th>e</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>40.297876</td> <td>-75.581294</td> <td>REINDEER CT &amp; DEAD END; NEW HANOVER; Station ...</td> <td>19525.0</td> <td>EMS: BACK PAINS/INJURY</td> <td>2015-12-10 17:40:00</td> <td>NEW HANOVER</td> <td>REINDEER CT &amp; DEAD END</td> <td>1</td> </tr> <tr> <th>1</th> <td>40.258061</td> <td>-75.264680</td> <td>BRIAR PATH &amp; WHITEMARSH LN; HATFIELD TOWNSHIP...</td> <td>19446.0</td> <td>EMS: DIABETIC EMERGENCY</td> <td>2015-12-10 17:40:00</td> <td>HATFIELD TOWNSHIP</td> <td>BRIAR PATH &amp; WHITEMARSH LN</td> <td>1</td> </tr> <tr> <th>2</th> <td>40.121182</td> <td>-75.351975</td> <td>HAWS AVE; NORRISTOWN; 2015-12-10 @ 14:39:21-St...</td> <td>19401.0</td> <td>Fire: GAS-ODOR/LEAK</td> <td>2015-12-10 17:40:00</td> <td>NORRISTOWN</td> <td>HAWS AVE</td> <td>1</td> </tr> <tr> <th>3</th> <td>40.116153</td> <td>-75.343513</td> <td>AIRY ST &amp; SWEDE ST; NORRISTOWN; Station 308A;...</td> <td>19401.0</td> <td>EMS: CARDIAC EMERGENCY</td> <td>2015-12-10 17:40:01</td> <td>NORRISTOWN</td> <td>AIRY ST &amp; SWEDE ST</td> <td>1</td> </tr> <tr> <th>4</th> <td>40.251492</td> <td>-75.603350</td> <td>CHERRYWOOD CT &amp; DEAD END; LOWER POTTSGROVE; S...</td> <td>NaN</td> <td>EMS: DIZZINESS</td> <td>2015-12-10 17:40:01</td> <td>LOWER POTTSGROVE</td> <td>CHERRYWOOD CT &amp; DEAD END</td> <td>1</td> </tr> </tbody> </table> </div> <h2 id="basic-analysis">Basic Analysis</h2> <p>Let’s check out the top 5 zipcodes for calls.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'zip'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>19401.0    6979
19464.0    6643
19403.0    4854
19446.0    4748
19406.0    3174
Name: zip, dtype: int64
</code></pre></div> <p>The top townships for the calls were as follows:</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'twp'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>LOWER MERION    8443
ABINGTON        5977
NORRISTOWN      5890
UPPER MERION    5227
CHELTENHAM      4575
Name: twp, dtype: int64
</code></pre></div> <p>For 90k + entries, how many unique call titles did we have?</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>110
</code></pre></div> <h2 id="data-wrangling-for-feature-creation">Data Wrangling for Feature Creation</h2> <p>We can extract some generalised features from the columns in our dataset for further analysis.</p> <p>In the <em>title</em> column, there’s a kind of ‘subcategory’ or ‘reason for call’ alloted to each entry (denoted by the text before the colon).</p> <p>The timestamp column can be further segregated into Year, Month and Day of Week too.</p> <p>Let’s start with creating a ‘Reason’ feature for each call.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">':'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div> <div> <table border="1" class="dataframe table-responsive"> <thead> <tr style="text-align: right;"> <th></th> <th>lat</th> <th>lng</th> <th>desc</th> <th>zip</th> <th>title</th> <th>timeStamp</th> <th>twp</th> <th>addr</th> <th>e</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <th>99487</th> <td>40.132869</td> <td>-75.333515</td> <td>MARKLEY ST &amp; W LOGAN ST; NORRISTOWN; 2016-08-2...</td> <td>19401.0</td> <td>Traffic: VEHICLE ACCIDENT -</td> <td>2016-08-24 11:06:00</td> <td>NORRISTOWN</td> <td>MARKLEY ST &amp; W LOGAN ST</td> <td>1</td> <td>Traffic</td> </tr> <tr> <th>99488</th> <td>40.006974</td> <td>-75.289080</td> <td>LANCASTER AVE &amp; RITTENHOUSE PL; LOWER MERION; ...</td> <td>19003.0</td> <td>Traffic: VEHICLE ACCIDENT -</td> <td>2016-08-24 11:07:02</td> <td>LOWER MERION</td> <td>LANCASTER AVE &amp; RITTENHOUSE PL</td> <td>1</td> <td>Traffic</td> </tr> <tr> <th>99489</th> <td>40.115429</td> <td>-75.334679</td> <td>CHESTNUT ST &amp; WALNUT ST; NORRISTOWN; Station ...</td> <td>19401.0</td> <td>EMS: FALL VICTIM</td> <td>2016-08-24 11:12:00</td> <td>NORRISTOWN</td> <td>CHESTNUT ST &amp; WALNUT ST</td> <td>1</td> <td>EMS</td> </tr> <tr> <th>99490</th> <td>40.186431</td> <td>-75.192555</td> <td>WELSH RD &amp; WEBSTER LN; HORSHAM; Station 352; ...</td> <td>19002.0</td> <td>EMS: NAUSEA/VOMITING</td> <td>2016-08-24 11:17:01</td> <td>HORSHAM</td> <td>WELSH RD &amp; WEBSTER LN</td> <td>1</td> <td>EMS</td> </tr> <tr> <th>99491</th> <td>40.207055</td> <td>-75.317952</td> <td>MORRIS RD &amp; S BROAD ST; UPPER GWYNEDD; 2016-08...</td> <td>19446.0</td> <td>Traffic: VEHICLE ACCIDENT -</td> <td>2016-08-24 11:17:02</td> <td>UPPER GWYNEDD</td> <td>MORRIS RD &amp; S BROAD ST</td> <td>1</td> <td>Traffic</td> </tr> </tbody> </table> </div> <p>Now, let’s find out the most common reason for 911 calls, according to our dataset.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>EMS        48877
Traffic    35695
Fire       14920
Name: Reason, dtype: int64
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">])</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1165ad710&gt;
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_20_1.png" alt="png" /></p> <p>Let’s deal with the time information we have. Checking the datatype of the timestamp column.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>str
</code></pre></div> <p>As the timestamps are still string types, it’ll make our life easier if we convert it to a python DateTime object, so we can extract the year, month, and day information more intuitively.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">])</span>
</code></pre></div> <p>For a single DateTime object, we can extract information as follows.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">time</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Hour:'</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Month:'</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Day of Week:'</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">)</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>Hour: 17
Month: 12
Day of Week: 3
</code></pre></div> <p>Now let’s create new features for the above pieces of information.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'Hour'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'Month'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'Day of Week'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">)</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div> <div> <table border="1" class="dataframe table-responsive"> <thead> <tr style="text-align: right;"> <th></th> <th>lat</th> <th>lng</th> <th>desc</th> <th>zip</th> <th>title</th> <th>timeStamp</th> <th>twp</th> <th>addr</th> <th>e</th> <th>Reason</th> <th>Hour</th> <th>Month</th> <th>Day of Week</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>40.297876</td> <td>-75.581294</td> <td>REINDEER CT &amp; DEAD END; NEW HANOVER; Station ...</td> <td>19525.0</td> <td>EMS: BACK PAINS/INJURY</td> <td>2015-12-10 17:40:00</td> <td>NEW HANOVER</td> <td>REINDEER CT &amp; DEAD END</td> <td>1</td> <td>EMS</td> <td>17</td> <td>12</td> <td>3</td> </tr> <tr> <th>1</th> <td>40.258061</td> <td>-75.264680</td> <td>BRIAR PATH &amp; WHITEMARSH LN; HATFIELD TOWNSHIP...</td> <td>19446.0</td> <td>EMS: DIABETIC EMERGENCY</td> <td>2015-12-10 17:40:00</td> <td>HATFIELD TOWNSHIP</td> <td>BRIAR PATH &amp; WHITEMARSH LN</td> <td>1</td> <td>EMS</td> <td>17</td> <td>12</td> <td>3</td> </tr> <tr> <th>2</th> <td>40.121182</td> <td>-75.351975</td> <td>HAWS AVE; NORRISTOWN; 2015-12-10 @ 14:39:21-St...</td> <td>19401.0</td> <td>Fire: GAS-ODOR/LEAK</td> <td>2015-12-10 17:40:00</td> <td>NORRISTOWN</td> <td>HAWS AVE</td> <td>1</td> <td>Fire</td> <td>17</td> <td>12</td> <td>3</td> </tr> </tbody> </table> </div> <p>The Day of the Week is an integer and it might not be instantly clear which number refers to which Day. We can map that information to a Mon-Sun string.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">dmap</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s">'Mon'</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s">'Tue'</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s">'Wed'</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s">'Thu'</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="s">'Fri'</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="s">'Sat'</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="s">'Sun'</span><span class="p">}</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'Day of Week'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'Day of Week'</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">dmap</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div> <div> <table border="1" class="dataframe table-responsive"> <thead> <tr style="text-align: right;"> <th></th> <th>lat</th> <th>lng</th> <th>desc</th> <th>zip</th> <th>title</th> <th>timeStamp</th> <th>twp</th> <th>addr</th> <th>e</th> <th>Reason</th> <th>Hour</th> <th>Month</th> <th>Day of Week</th> </tr> </thead> <tbody> <tr> <th>99489</th> <td>40.115429</td> <td>-75.334679</td> <td>CHESTNUT ST &amp; WALNUT ST; NORRISTOWN; Station ...</td> <td>19401.0</td> <td>EMS: FALL VICTIM</td> <td>2016-08-24 11:12:00</td> <td>NORRISTOWN</td> <td>CHESTNUT ST &amp; WALNUT ST</td> <td>1</td> <td>EMS</td> <td>11</td> <td>8</td> <td>Wed</td> </tr> <tr> <th>99490</th> <td>40.186431</td> <td>-75.192555</td> <td>WELSH RD &amp; WEBSTER LN; HORSHAM; Station 352; ...</td> <td>19002.0</td> <td>EMS: NAUSEA/VOMITING</td> <td>2016-08-24 11:17:01</td> <td>HORSHAM</td> <td>WELSH RD &amp; WEBSTER LN</td> <td>1</td> <td>EMS</td> <td>11</td> <td>8</td> <td>Wed</td> </tr> <tr> <th>99491</th> <td>40.207055</td> <td>-75.317952</td> <td>MORRIS RD &amp; S BROAD ST; UPPER GWYNEDD; 2016-08...</td> <td>19446.0</td> <td>Traffic: VEHICLE ACCIDENT -</td> <td>2016-08-24 11:17:02</td> <td>UPPER GWYNEDD</td> <td>MORRIS RD &amp; S BROAD ST</td> <td>1</td> <td>Traffic</td> <td>11</td> <td>8</td> <td>Wed</td> </tr> </tbody> </table> </div> <p>Let’s combine the newly created features, to check out the most common call reasons based on the day of the week.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'Day of Week'</span><span class="p">],</span><span class="n">hue</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.legend.Legend at 0x116d9cbe0&gt;
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_34_1.png" alt="png" /></p> <p>It makes sense for the number of traffic related 911 calls to be the lowest during the weekends, what’s also iteresting is that Emergency Service related calls are also low during the weekend.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'Month'</span><span class="p">],</span><span class="n">hue</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.legend.Legend at 0x117dd1c88&gt;
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_36_1.png" alt="png" /></p> <p>Now, let’s check out the relationship between the number of calls and the month.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">byMonth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">by</span><span class="o">=</span><span class="s">'Month'</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">byMonth</span><span class="p">[</span><span class="s">'e'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'e'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Calls per Month'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Number of Calls'</span><span class="p">)</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.text.Text at 0x1031d65c0&gt;
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_39_1.png" alt="png" /></p> <p>Using seaborn, let’s fit the number of calls to a month and see if there’s any concrete correlation between the two.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">byMonth</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Month'</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">'e'</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">byMonth</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Number of Calls'</span><span class="p">)</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;matplotlib.text.Text at 0x109aa7fd0&gt;
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_42_1.png" alt="png" /></p> <p>So, it does seem that there are fewer emergency calls during the holiday seasons.</p> <p>Let’s extract the date from the timestamp, and see behavior in a little more detail.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'Date'</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'timeStamp'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
</code></pre></div> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div> <div> <table border="1" class="dataframe table-responsive"> <thead> <tr style="text-align: right;"> <th></th> <th>lat</th> <th>lng</th> <th>desc</th> <th>zip</th> <th>title</th> <th>timeStamp</th> <th>twp</th> <th>addr</th> <th>e</th> <th>Reason</th> <th>Hour</th> <th>Month</th> <th>Day of Week</th> <th>Date</th> </tr> </thead> <tbody> <tr> <th>0</th> <td>40.297876</td> <td>-75.581294</td> <td>REINDEER CT &amp; DEAD END; NEW HANOVER; Station ...</td> <td>19525.0</td> <td>EMS: BACK PAINS/INJURY</td> <td>2015-12-10 17:40:00</td> <td>NEW HANOVER</td> <td>REINDEER CT &amp; DEAD END</td> <td>1</td> <td>EMS</td> <td>17</td> <td>12</td> <td>Thu</td> <td>2015-12-10</td> </tr> <tr> <th>1</th> <td>40.258061</td> <td>-75.264680</td> <td>BRIAR PATH &amp; WHITEMARSH LN; HATFIELD TOWNSHIP...</td> <td>19446.0</td> <td>EMS: DIABETIC EMERGENCY</td> <td>2015-12-10 17:40:00</td> <td>HATFIELD TOWNSHIP</td> <td>BRIAR PATH &amp; WHITEMARSH LN</td> <td>1</td> <td>EMS</td> <td>17</td> <td>12</td> <td>Thu</td> <td>2015-12-10</td> </tr> </tbody> </table> </div> <p>Grouping and plotting the data:</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s">'Date'</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s">'e'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'e'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_47_0.png" alt="png" /></p> <p>We can also check out the same plot for each reason separately.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">]</span><span class="o">==</span><span class="s">'Traffic'</span><span class="p">],</span><span class="s">'Date'</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'e'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Traffic'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_49_0.png" alt="png" /></p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">]</span><span class="o">==</span><span class="s">'Fire'</span><span class="p">],</span><span class="s">'Date'</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'e'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Fire'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_50_0.png" alt="png" /></p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Reason'</span><span class="p">]</span><span class="o">==</span><span class="s">'EMS'</span><span class="p">],</span><span class="s">'Date'</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'e'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'EMS'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_51_0.png" alt="png" /></p> <p>Let’s create a heatmap for the counts of calls on each hour, during a given day of the week.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">day_hour</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s">'lat'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="s">'Day of Week'</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="s">'Hour'</span><span class="p">,</span><span class="n">aggfunc</span><span class="o">=</span><span class="s">'count'</span><span class="p">)</span>

<span class="n">day_hour</span>
</code></pre></div> <div> <table border="1" class="dataframe table-responsive"> <thead> <tr style="text-align: right;"> <th>Hour</th> <th>0</th> <th>1</th> <th>2</th> <th>3</th> <th>4</th> <th>5</th> <th>6</th> <th>7</th> <th>8</th> <th>9</th> <th>...</th> <th>14</th> <th>15</th> <th>16</th> <th>17</th> <th>18</th> <th>19</th> <th>20</th> <th>21</th> <th>22</th> <th>23</th> </tr> <tr> <th>Day of Week</th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <th>Fri</th> <td>275</td> <td>235</td> <td>191</td> <td>175</td> <td>201</td> <td>194</td> <td>372</td> <td>598</td> <td>742</td> <td>752</td> <td>...</td> <td>932</td> <td>980</td> <td>1039</td> <td>980</td> <td>820</td> <td>696</td> <td>667</td> <td>559</td> <td>514</td> <td>474</td> </tr> <tr> <th>Mon</th> <td>282</td> <td>221</td> <td>201</td> <td>194</td> <td>204</td> <td>267</td> <td>397</td> <td>653</td> <td>819</td> <td>786</td> <td>...</td> <td>869</td> <td>913</td> <td>989</td> <td>997</td> <td>885</td> <td>746</td> <td>613</td> <td>497</td> <td>472</td> <td>325</td> </tr> <tr> <th>Sat</th> <td>375</td> <td>301</td> <td>263</td> <td>260</td> <td>224</td> <td>231</td> <td>257</td> <td>391</td> <td>459</td> <td>640</td> <td>...</td> <td>789</td> <td>796</td> <td>848</td> <td>757</td> <td>778</td> <td>696</td> <td>628</td> <td>572</td> <td>506</td> <td>467</td> </tr> <tr> <th>Sun</th> <td>383</td> <td>306</td> <td>286</td> <td>268</td> <td>242</td> <td>240</td> <td>300</td> <td>402</td> <td>483</td> <td>620</td> <td>...</td> <td>684</td> <td>691</td> <td>663</td> <td>714</td> <td>670</td> <td>655</td> <td>537</td> <td>461</td> <td>415</td> <td>330</td> </tr> <tr> <th>Thu</th> <td>278</td> <td>202</td> <td>233</td> <td>159</td> <td>182</td> <td>203</td> <td>362</td> <td>570</td> <td>777</td> <td>828</td> <td>...</td> <td>876</td> <td>969</td> <td>935</td> <td>1013</td> <td>810</td> <td>698</td> <td>617</td> <td>553</td> <td>424</td> <td>354</td> </tr> <tr> <th>Tue</th> <td>269</td> <td>240</td> <td>186</td> <td>170</td> <td>209</td> <td>239</td> <td>415</td> <td>655</td> <td>889</td> <td>880</td> <td>...</td> <td>943</td> <td>938</td> <td>1026</td> <td>1019</td> <td>905</td> <td>731</td> <td>647</td> <td>571</td> <td>462</td> <td>274</td> </tr> <tr> <th>Wed</th> <td>250</td> <td>216</td> <td>189</td> <td>209</td> <td>156</td> <td>255</td> <td>410</td> <td>701</td> <td>875</td> <td>808</td> <td>...</td> <td>904</td> <td>867</td> <td>990</td> <td>1037</td> <td>894</td> <td>686</td> <td>668</td> <td>575</td> <td>490</td> <td>335</td> </tr> </tbody> </table> <p>7 rows × 24 columns</p> </div> <p>** Now create a HeatMap using this new DataFrame. **</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">day_hour</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_55_0.png" alt="png" /></p> <p>We see that most calls take place around the end of office hours on weekdays. We can create a clustermap to pair up similar Hours and Days.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">sns</span><span class="o">.</span><span class="n">clustermap</span><span class="p">(</span><span class="n">day_hour</span><span class="p">)</span>
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;seaborn.matrix.ClusterGrid at 0x11c49f320&gt;
</code></pre></div> <p><img src="/public/project-images/911_calls_eda/output_57_1.png" alt="png" /></p> <p>And this concludes the exploratory analysis project.</p> </div> <hr> <div class="back-to-top"> <i class="fa fa-arrow-circle-up fa-2x animated infinite pulse" aria-hidden="true"></i> </div> <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> </div> </div> <label for="sidebar-checkbox" class="sidebar-toggle"></label> <script> (function(document) { var toggle = document.querySelector('.sidebar-toggle'); var sidebar = document.querySelector('#sidebar'); var checkbox = document.querySelector('#sidebar-checkbox'); document.addEventListener('click', function(e) { var target = e.target; if(!checkbox.checked || sidebar.contains(target) || (target === checkbox || target === toggle)) return; checkbox.checked = false; }, false); })(document); </script> <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"> </script> <script> $(".back-to-top i").click(function(){ $('body,html').animate({ scrollTop: 0 }, 2000); }); </script> </body> </html>
